import pygame
import sys
import random
import math

# 初始化pygame
pygame.init()

# 设置窗口
width, height = 800, 600
screen = pygame.display.set_mode((width, height))
pygame.display.set_caption("快乐动画")

# 颜色
BLACK = (0, 0, 0)
WHITE = (255, 255, 255)
YELLOW = (255, 255, 0)
BLUE = (0, 0, 255)

# 笑脸参数
face_radius = 50
face_x = width // 2
face_y = height // 2
face_dx = 3
face_dy = 3

# 星星参数
stars = []
for _ in range(50):
    stars.append([
        random.randint(0, width),
        random.randint(0, height),
        random.randint(1, 3),
        random.choice([(255, 0, 0), (0, 255, 0), (0, 0, 255), (255, 255, 0), (255, 0, 255)]),
        random.randint(0, 100)  # 闪烁计时器
    ])

# 背景颜色变化参数
bg_color = [0, 0, 0]
color_change = [1, 1, 1]

# 主循环
clock = pygame.time.Clock()
running = True

while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
    
    # 更新背景颜色
    for i in range(3):
        bg_color[i] += color_change[i]
        if bg_color[i] >= 150 or bg_color[i] <= 0:
            color_change[i] *= -1
    
    # 填充背景
    screen.fill(bg_color)
    
    # 更新星星
    for star in stars:
        star[4] += 1
        if star[4] > 100:
            star[4] = 0
            star[3] = random.choice([(255, 0, 0), (0, 255, 0), (0, 0, 255), (255, 255, 0), (255, 0, 255)])
        
        alpha = abs(50 - star[4]) / 50 * 255
        star_color = (star[3][0], star[3][1], star[3][2], alpha)
        
        star_surface = pygame.Surface((star[2]*2, star[2]*2), pygame.SRCALPHA)
        pygame.draw.circle(star_surface, star_color, (star[2], star[2]), star[2])
        screen.blit(star_surface, (star[0], star[1]))
    
    # 更新笑脸位置
    face_x += face_dx
    face_y += face_dy
    
    # 边界检测
    if face_x - face_radius <= 0 or face_x + face_radius >= width:
        face_dx *= -1
    if face_y - face_radius <= 0 or face_y + face_radius >= height:
        face_dy *= -1
    
    # 绘制笑脸
    pygame.draw.circle(screen, YELLOW, (face_x, face_y), face_radius)
    
    # 眼睛
    pygame.draw.circle(screen, BLACK, (face_x - 20, face_y - 15), 7)
    pygame.draw.circle(screen, BLACK, (face_x + 20, face_y - 15), 7)
    
    # 嘴巴
    pygame.draw.arc(screen, BLACK, (face_x - 30, face_y - 10, 60, 40), 0.2, 2.9, 3)
    
    # 显示快乐文字
    font = pygame.font.SysFont('Arial', 30)
    text = font.render("快乐每一天!", True, WHITE)
    screen.blit(text, (width//2 - text.get_width()//2, 20))
    
    # 更新显示
    pygame.display.flip()
    
    # 控制帧率
    clock.tick(60)

pygame.quit()
sys.exit()
